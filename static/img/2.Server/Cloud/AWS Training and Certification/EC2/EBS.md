# EBS
![Pasted image 20230801085339.png](../../../../Pasted image 20230801085339.png)
:::note EBS?
- EBS는 Elastic Block Store의 줄임말 입니다.
- 인스턴스가 실행 중인 동안 연결 가능한 네트워크 드라이브 입니다.
:::

- EBS 볼륨을 사용하면 인스턴스가 종료된 후에도 데이터를 지속 할 수 있습니다.
	- 인스턴스를 종료 후 재시작해도 EBS 볼륨을 마은트 하면 데이터를 다시 받을 수 있습니다.
- 그리고 CCP 레벨의 EBS 볼륨은 한 번에 하나의 인스턴스만 마운트 가능합니다.
	- EBS 볼륨은 특정 AZ에서 사용 가능합니다.
		- 만약 EBS -> `ap-northeast-2a` 라면
		- `ap-northeast-2c` 에서는 연결이 불가능 합니다.
:::tip CCP?
- 하나의 EBS는 하나의 EC2 인스턴스에만 마운트 가능

:::

:::tip Associate Level
- 일부 EBS 다중 연결
:::

- EBS를 쉽게 생각하면 USB 스틱처럼 생각하면 쉽습니다.
	- 한 컴퓨터에서 꺼내 다른 컴퓨터에 꽂는 장치를 의미하며, 실제로는 네트워크로 통신할 뿐입니다.
:::info Freetier
- 30GB의 EBS 스토리지가 무료이며
- SSD 혹은 HDD로 사용 가능합니다.

:::

## EBS Volume
- 해당 드라이브는 network drive 입니다.
	- 물리적 drive가 아닙니다.
- 즉, EBS 볼륨을 사용하기 위해서는 <mark>네트워크</mark>가 사용 됩니다.
	- 컴퓨터가 다른 서버에 도달 할 때 지연이 생길 수도 있습니다.
- EBS 볼륨은 네트워크 볼륨이기에, EC2 인스턴스에서 분리 될 수도 있으며, 매우 빠르게 다른 인스턴스로 연결될 수 있습니다.
- EBS 볼륨은 특정 가용 영역(AZ)에 귀속되어 있기 때문에, 다른 AZ에서는 사용이 불가능하다
	- 하지만, 스냅샵을 이용해서 똑같은 EBS 볼륨을 옮겨서 사용은 가능하다.
- 볼륨이기 때문에, 원하는 양의 GB 및 IOPS(단위 초당 전송 수)미리 지정해야 합니다.
	- 사용자가 원하는 스펙 사양을 미리 정하는 것이다.
- 프로비전 용량에 따라 요금이 청구되며, 추후에 용량과 IOPS를 늘리는 것이 가능합니다.

## EBS Volume Example
![Pasted image 20230801092033.png](../../../../Pasted image 20230801092033.png)
- 하나의 <mark>EBS 볼륨</mark>은 <mark>하나의 EC2</mark>를  붙일 수 있습니다.
- <mark>하나의 EC2</mark>에서는 <mark>여러 개의 EBS 볼륨</mark>을 붙일 수 있습니다.
- 만약 다른 가용 영역(AZ)에 있는 EC2에 EBS 볼륨을 사용하려면 해당 가용 영역(AZ)에 EBS 볼륨을 만들어야합니다.

## EBS - Delete on Termination attirbute
- EBS 볼륨을 생성하는 옵션 중에서 <mark>종료 시 삭제</mark> 라는 옵션이 있습니다.
![Pasted image 20230801093739.png](../../../../Pasted image 20230801093739.png)
- EC2인스턴스를 생성할 때 콘솔에서 EBS 볼륨을 생성하면 끝에서 두번째에 `Delete on Termination` 이라는 옵션이 있습니다.
- 기본 설정으로는 Root Volume에 체크 되어있으며, EBS 볼륨은 체크 되어있지 않습니다.
- UI에서 해당 활성 상태를 제어할 수 있습니다.
- 만약에 EC2 종료시에도 Root 볼륨을 그대로 유지 시켜야한다면, 해당 `Delete on Termination`을 비활성화 하면 됩니다.

# EBS Snapshots
:::note EBS Snapshot?
- EBS 스냅샷은 EBS 볼륨의 특정 시점에서의 백업입니다.
- 이를 위해서는 EC2 인스턴스에서 EBS 볼륨을 분리할 필요는 없지만, 권장하지 않습니다.
- 왠만하면, EC2인스턴스에서 분리 후에 Snapshot을 진행하는 것을 추천합니다.
:::

- EBS 스냅샷은 다른 가용 영역(AZ) 또는 다른 리전에 복사할 수 있습니다.
![Pasted image 20230801104713.png](../../../../Pasted image 20230801104713.png)
- 따라서 이것은 EBS 볼륨을 한 인스턴스에서 다른 인스턴스로 전송하는 방법이라고 할 수 있습니다.

## EBS Snapshots Features

### EBS Snapshot Archive
- 스냅샷을 최대 75% 더 저렴한 아카이브 티어로 옮길 수 있는 기능입니다.
- 스냅샷을 아카이브 티어로 옮기면 아카이브를 복원하는 데 24시간에서 72시간 정도 소요됩니다.
![Pasted image 20230801105015.png](../../../../Pasted image 20230801105015.png)

### Recycle Bin for EBS Snapshots
- EBS 스냅샷을 영구적으로 삭제하는 대신 휴지통에 보관합니다.
- 휴지통에 보관할 경우, 실수로 삭제한 경우 복구가 가능합니다.
	- 보관 기간은 하루 ~ 1년까지 설정이 가능합니다.
![Pasted image 20230801105206.png](../../../../Pasted image 20230801105206.png)

### Fast Snapshot Restore(FSR)
- 스냅샷을 처음 사용할 때 대기 시간이 없도록, 해당 기능은 스냅샷을 완전히 초기화 하는 것입니다.
- 이 기능은 특히 **스냅샷이 매우 클 때** EBS 볼륨을 초기화 해야 하거나 또는 **매우 빠르게 인스턴스화 해야하는 경우** 유리합니다.
	- 해당 기능은 돈이 매우 많이 듭니다.
![Pasted image 20230801105808.png](../../../../Pasted image 20230801105808.png)

# EBS Volume Types
- 총 6개의 유형이 있고, 이들을 여러 범주로 나눌 수 있습니다.
	- gp2 / gp3 (SSD): 범용 SSD 볼륨으로 다양한 워크로드에 대해 가격과 성능의 절충 안이 되어 줍니다.
	- io1 / io2 (SSD) : 최고 성능을 자랑하는 SSD 볼륨으로 미션 크리티컬이자 지연 시간이 낮고 대용량의 워크 로드에 쓰입니다
	- st1 (HDD) : 이는 저 비용의 HDD 볼륨으로 잦은 접근과 처리량이 많은 워크로드에 쓰입니다.
	- sc1 (HDD) : 가장 비용이 적게 드는 HDD 볼륨으로 접근 빈도가 낮은 워크로드를 위해 설계 되었습니다.
- EC2 인스턴스는 gp2 / gp3와 io1 / io2만이 부팅 볼륨으로 사용될 수 있습니다. -> root OS 가 실행될 위치에 해당합니다.

## 범용 SSD
- 짧은 지연 시간을 자랑하며, 효율적인 비용의 스토리지입니다.
- 시스템 부팅 볼륨에서 가상 데스크톱, 개발, 테스트 환경에서 사용할 수 있습니다.
- 크기는 1GiB 부터 16TiB까지 다양하게 존재합니다.
### GP3
- gp3는 최신 세대의 볼륨으로 기본 성능으로 3000 IOPS와 초당 125MB의 처리량을 제공합니다.
- 각각 IOPS는 최대 16,000이고, 초당 1000MB 까지 처리량을 증가시킬 수도 있습니다.

### GP2
- 예전의 버전으로 볼륨이 더 작습니다.
- 최대 3000 IOPS이며, IOPS와 볼륨이 연결되어있습니다.
- 그렇기 때문에 볼륨이 증가할 수록 IOPS는 늘어나게 되며, 16,000까지 증가합니다.

- IOPS 성능을 유지해야만 하는 주요 비즈니스 애플리케이션이나 16,000IOPS 이상을 요하는 애플리케이션에 적합합니다.
- 일반적으로는 데이터베이스 워크로드에 알맞습니다.
	- 이는 스토리지 성능과 일관성에 아주 민감한데, 
	- 따라서 최소 gp2/gp3에서 io1/io2를 선택해야하며,
	- io1/io2는 최소 4GiB ~ 16TiB 정도의 용량을 가지고 있으며, Nitro EC2인스턴스에서 최대 64,000 IOPS까지 가능합니다.
	- Nitro EC2 인스턴스의 경우 이틀 통해 더 높은 IOPS까지 이용할 수 있습니다.
	- Nitro EC2 인스턴스가 아닌 경우에는 최대 32,000 IOPS까지 지원됩니다.
		- 또한 io1/io2도 스토리지 크기와 독자적으로 증가 시킬 수 있습니다.

### io2
- io1과 동일한 비용으로 내구성과 기가당 IOPS의 수가 더 높습니다.
- 현재까지는 io2를 사용하는 것이 합리적입니다.
#### io2 Block Express(4Gib ~ 64TiB)
- 더 고성능 유형의 볼륨입니다.
- 지연 시간이 밀리토 미만이며, IOPS 대 GB 비율이 1,000 : 1일 최대 256,000 IOPS를 자랑합니다.

## HDD
- 해당 볼륨은 Boot 볼륨으로 사용 할 수 없습니다.
- 이전 유형의 볼륨이며, 125MiB ~ 16TiB까지 확장 가능합니다.
- 빅데이터, 데이터 웨어하우징, 로그 처리에 적합합니다.
- 최대 처리량은 초당 500MB, 최대 IOPS는 500에 달합니다.
#### Cold HDD
- 접근 빈도가 낮은 데이터에 적합합니다.
- 최저 비용으로 데이터를 저장할 때 사용합니다.
- 최대 처리량은 초당 250MB, 최대 IOPS도 250입니다.
![Pasted image 20230804091559.png](../../../../Pasted image 20230804091559.png)

# EBS 다중 연결
:::note EBS 다중 연결
- 다중 첨부 기능을 사용하면 동일한 EBS 볼륨을 동일한 가용 영역에 있는 여러 개의 EC2인스턴스에 첨부할 수 있다.

:::

![Pasted image 20230804092318.png](../../../../Pasted image 20230804092318.png)
- io2 볼륨이 있는 경우, 다중 첨부 기능을 사용하도록 설정하면, 볼륨을 한 번에 여러 EC2 인스턴스에 부착 할 수 있다.
	- EBS 볼륨 중 io1 및 io2 제품군에서만 사용할 수 있다.
- 각 인스턴스는 고성능 볼륨에 대한 전체 읽기 및 쓰기 권한을 갖게 됩니다.
- 즉, 모두 동시에 쓰기와 읽기가 가능합니다.
- 사용 사례는 클러스터된 Linux 애플리케이션의 경우, 애플리케이션 가용성이 높아진다는 것이다.
	- Teradata 같은 경우를 예로 들을 수 있습니다.
- 참고로, 다중 첨부 기능은 당연히 지정된 가용 영역 내에서만 사용할 수 있습니다.
- 한 AZ의 EBS 볼륨을 다른 AZ에 첨부할 수 없다.
- 다중 기능의 또 다른 제약 조건은 하나의 볼륨은 한번에 **최대 16개**의 EC2 인스턴스에 부착 할 수 있다.
- 이 기능이 작동하려면  클러스터를 인식할 수 있는 파일 시스템을 사용해야 합니다.(XFS나 Xe4 말)

---

#AWS_EC2 #AWS #AWS_EBS #AWS_DEVLOPER 

---
