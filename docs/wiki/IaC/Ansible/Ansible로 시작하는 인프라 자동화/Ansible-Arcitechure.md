---
slug: "Ansible-Arcitechure"
---
Ansible은 크게 커뮤니티 앤서블과 레드햇 앤서블 오토메이션 플랫폼으로 나누어 설명합니다.
- 커뮤니티 앤서블
	- 오픈소스 형태로 운영체제가 리눅스라면, 어디에나 설치 하여 사용 가능합니다.
- 레드헷 앤서블 오토메이션 플랫폼
	- 레드햇 서브스크립션을 통해 설치 가능합니다.

# 커뮤니티 앤서블
앤서블 아키텍처는 제어 노드와 관리 노드라는 두가지 유형의 시스템으로 구성됩니다.
앤서블은 제어 노드에 설치되어 실행되며, 앤서블이 실행되기 위해서는 파이썬이 기본적으로 설치 되어 있어야 합니다.

또한 앤서블 안에는 다양한 모듈과 플러그인이 함께 설치 되어 있으며, 앤서블이 관리하는 노드 정보를 저장하고 있는 인벤토리와 관리 노드에서 수행될 작업 절차가 작성되어 있는 플레이북이 존재합니다.
![Pasted-image-20250319155802.png](/img/이미지 창고/Pasted-image-20250319155802.png)

## 제어 노드
Control Node는 앤서블이 설치되는 노드로 운영 체제가 리눅스라면 제어 노드가 될 수 있습니다.
앤서블은 파이썬 모듈을 이용하므로, 앤서블을 설치하고 실행하려면 파이썬이 함께 설치 되어 있어야 합니다.

## 관리 노드
Managed Node는 앤서블이 제어하는 원격 시스템 혹은 host를 의미합니다.
관리 노드는 위 그림 처럼 리눅스가 설치된 노드 일수도 있고, 윈도우가 설치된 노드 일수도 있습니다.
또는 퍼블릭 클라우드나 프라이빗 클라우드 시스템에서 생성한 가상 서버가 될 수도 있습니다.
앤서블은 별도의 에이전트를 설치하지 않으므로, 관리 노드는 제어 노드와 SSH 통신이 가능해야하며, 파이썬이 설치되어 있어야 합니다.


## 인벤토리
`inventory` 는 제어노드가 제어하는 관리 노드의 목록을 나열해 놓은 파일입니다.
앤서블은 인벤토리에 사전에 정의되어 있는 관리 노드에만 접근 할 수 있습니다.

또한 인벤토리 목록은 관리 노드의 성격 별로 다음과 같이 그룹핑 할 수 있습니다.

```shell
vi inventory
192.168.10.101

[WebServer]
web1.example.com
web2.example.com

[DBServer]
db1.example.com
db2.example.com
```

## 모듈
앤서블은 관리 노드의 작업을 수행할 때 SSH 를 통해 연결한 후 앤서블 모듈이라는 스크립트를 푸시하여 작동합니다.
대부분의 모듈은 원하는 시스템 상태를 설명하는 매개 변수를 허용하며, 모듈 실행이 완료되면 제거 됩니다.

## 플러그인
`Plugin` 은 앤서블의 핵심 기능을 강화합니다.
모듈이 대상 시스템에서 별도의 프로세스로 실행되는 동안 플러그인은 제어 노드에서 실행됩니다.
플러그인은 앤서블의 핵심 기능(데이터 변환, 로그 출력, 인벤토리 연결) 에 대한 옵션 및 확장 기능을 제공합니다.

## 플레이북
플레이북은 관리 노드에서 수행할 작업들을 YAML 문법을 이용해 순서대로 작성해놓은 파일입니다.
앤서블은 이렇게 작성된 플레이북을 활용하여, 관리 노드에 SSH로 접근해 작업을 수행합니다.
따라서 플레이북은 자동화를 완성하는 가장 중요한 파일이며, 사용자가 직접 작성합니다.

```yaml
---
- hosts: webservers
- serial: 5 # 한 번에 5대의 머신을 업데이트 하라는 의미
- roles:
	- common
	- webapp
- hosts: content_servers
	- roles:
		- common
		- content
```

지금까지 커뮤니티 앤서블 아키텍처를 살펴보았습니다.
이어서 레드햇 앤서블 오토메이션 플랫폼 아키텍처를 살펴보겠습니다.

## 앤서블 오토메이션 플랫폼
커뮤니티 앤서블이나 레드햇의 앤서블 오토메이션 플랫폼(AAP) 의 주요 컴포넌트는 동일합니다.
다만 앤서블 오토메이션 플랫폼에는 커뮤니티 앤서블과 다르게 인벤토리, 제어 노드에 대한 인증 정보, 실행 환경 등을 관리하는 CMDB(Configuration Management Database)가 존재합니다.
또한 이런 자원들을 관리하는 웹 UI가 존재하며 REST API를 제공합니다.
![Pasted-image-20250319161526.png](/img/이미지 창고/Pasted-image-20250319161526.png)
앤서블 플레이북은 사용자가 외부에서 작성한 내용을 앤서블 관리 웹 UI를 통해 가져올 수 있습니다.
그리고 host, application 및 service, public 및 private cloud, networking과 같은 다양한 환경에 접속하여 플레이북에 작성된 작업을 수행합니다.

레드햇 앤서블 오토메이션 플랫폼은 다음과 같이 3가지 필수 컴포넌트와 1가지 옵셔널 컴포넌트로 구성 됩니다.

- 오토메이션 컨트롤러
	- 앤서블 타워로 불리던 앤서블 관리 Web UI
- 실행환경
	- 앤서블 모듈과 플러그인이 존재하는 컨테이너 기반의 실행 환경
- PostgreSQL
	- 인벤토리, 인증 정보, 실행환경 등의 메타데이터를 관리하는 CMDB
- 오토메이션 허브(옵션) 
	- 레드헷에서 기술 지원을 받을 수 있는 컬렉션 제공 서비스

![Pasted-image-20250319162035.png](/img/이미지 창고/Pasted-image-20250319162035.png)























---

#IaC #Ansible 