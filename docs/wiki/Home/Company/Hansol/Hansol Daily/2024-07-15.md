---
sticker: emoji//1f4c6
종료 날짜: 2024-07-15
시작 날짜: 2024-07-15
분류: 노트
카테고리:
  - Application
특징:
  - Front
  - Nuxt3
---
[FE/BE] 그리드 컬럼 정의와 상관없이 셀렉트 데이터를 그대로 CUD에 전달하여 사용 방법.

컬럼 정의에 넘길 데이터 컬럼 정의가 꼭 필요하다면 안 보이게 히든 처리 방법.

## 컬럼 Hidden type 생성

- RealGrid 같은 경우는 Aggrid와는 다르게 보여주는 컬럼과 데이터로 받아오는 컬럼이 무조건 1:1 관계이므로, 만약 이에 대한 컬럼 설정이 불일치 하다면, 오류를 내 뱉는다.

`HGrid`

```tsx
<template>
    <div :ref="gridName" :data-type="`HGrid-${gridName}`" class="flex flex_d_c" :style="gridWrapStyle">
        <div class="topTitleArea">
            <div v-if="gridTitle" class="leftArea">
                <h3 class="h3title">{{ hlang(gridTitle) }}</h3>
            </div>
            <div class="rightArea">
                <HComponentLoader v-for="(item, index) in gridToolbarItems" :key="index" :conf="item" :param="param" />
                <HButton v-if="gridEditable" :conf="addRowBtnConfig" @click="addRows"></HButton>
                <HButton v-if="gridEditable" :conf="deleteRowBtnConfig" @click="deleteRows"></HButton>
                <HButton v-if="gridCudApi && showGridSaveButton" :conf="saveRowsBtnConfig" @click="saveCudRows"></HButton>
            </div>
        </div>
        <div ref="gridTargetDiv" class="flex1" :style="gridAreaStyle" />
    </div>
</template>

<script setup lang="ts">
// <https://github.com/realgrid/realgrid2-examples/tree/master/vue3-typescript-vite>
import RealGrid, { GridFitStyle, GridView, LocalDataProvider } from 'realgrid'
import type { CellIndex, DataFieldInput, DataColumn, GridBase } from 'realgrid'

const props = defineProps({
    conf: {
        type: Object as PropType<htype.IGridUi>,
        required: true,
    },
    param: {
        type: Object,
        default: () => {},
    },
})
const confProps = props.conf ?? {}
const paramProps = props.param ?? {}

// ------------- grid info ----------------
const gridName = confProps.name
const gridTitle = confProps.title ?? ''
const gridToolbarItems = confProps.toolbar?.items

// ------------- UI API ----------------
const huiPage = hui.getPage(paramProps.pcd)
const huiGrid = huiPage.getGrid(gridName)

// ------------- events ----------------
const gridEvent = confProps.event

const addEventsOnGrid = () => {
    huiPage.event(gridName).on('load-grid-evt', handleLoadGrid)
    huiPage.event(gridName).on('reload-grid-evt', handleReloadGrid)
}

let beforeLoadParams = {}
const handleLoadGrid = async (args?: any) => {
    beforeLoadParams = args
    loadGridRemoteData(args)
}
const handleReloadGrid = async () => {
    loadGridRemoteData(beforeLoadParams)
}

const onCellDblClicked = (grid: GridBase, cellInfo: any) => {
    if (gridEvent?.doubleClicked) {
        const clickData = realGridDataProvider.getJsonRow(cellInfo.dataRow)
        huiPage.func().call(gridEvent.doubleClicked, clickData)
    }
    return true
}

// ------------- data ----------------
const gridApi = confProps.api
const gridAutoLoad = confProps.autoLoad ?? true
const gridCudApi = gridApi?.cud
const showGridSaveButton = gridCudApi?.showSaveButton ?? false

const callGridApi = async (mode: string, apiInfo: any, params?: any) => {
    if (mode === 'read') {
        const _params = { ...apiInfo.params, ...params }
        const result = await callRemoteApi(apiInfo, _params)
        let _data = result?.data
        if (gridEvent?.dataLoaded) {
            _data = huiPage.func().call(gridEvent.dataLoaded, _data)
        }
        return _data
    } else if (mode === 'cud') {
        const cudData = huiGrid.api.getCUDRows()
        await callRemoteApi(apiInfo, cudData)
        // if (result?.status) {
        //     alert('데이터를 저장했습니다.')
        // }
    } else if (mode === 'create') {
        const _params = {
            C: huiGrid.api.getCUDRows('C'),
        }
        await callRemoteApi(apiInfo, _params)
    } else if (mode === 'update') {
        const _params = {
            U: huiGrid.api.getCUDRows('U'),
        }
        await callRemoteApi(apiInfo, _params)
    } else if (mode === 'delete') {
        const _params = {
            D: huiGrid.api.getCUDRows('D'),
        }
        await callRemoteApi(apiInfo, _params)
    }
}

async function callRemoteApi(apiInfo: any, _params: any) {
    let resultData
    console.log(apiInfo, _params)
    if (apiInfo?.url) {
        resultData = await hdata.post(apiInfo.url, _params)
    } else if (apiInfo?.serviceId) {
        const finalParams = {
            serviceId: apiInfo.serviceId,
            serviceParam: { ..._params },
        }
        resultData = await hdata.post('/api/service/crud', finalParams)
    } else {
        return
    }

    return resultData
}

const loadInitialGridData = async (readApi: any, data: any) => {
    if (readApi) {
        data = await callGridApi('read', readApi, readApi?.params)
    }
    realGridDataProvider.fillJsonData(data)
}

const loadGridRemoteData = async (params: any) => {
    const data = await callGridApi('read', gridApi?.read, params)
    realGridDataProvider.fillJsonData(data)
}

// ------------- style ----------------
const gridWrapStyle = `height: ${confProps.height ?? '100%'};`
const gridAreaStyle = `width: ${confProps.width ?? '100%'};`

// ------------- editing ----------------
const gridEditable = confProps.editable ?? false

// ------------- grid Action ----------------
const addRowBtnConfig = {
    name: 'gridAddRow',
    text: '',
    class: 'btn_primary line textHide',
    fontIcon: 'mdi mdi-plus',
}
const addRows = () => {
    huiGrid.api.addRow()
}

const deleteRowBtnConfig = {
    name: 'gridDeleteRow',
    text: '',
    class: 'btn_primary line textHide',
    fontIcon: 'mdi mdi-minus',
}
const deleteRows = () => {
    huiGrid.api.deletedRow()
}

const saveRowsBtnConfig = {
    name: 'gridSaveCudRows',
    text: '저장',
    class: 'btn_transactional',
    fontIcon: 'mdi mdi-content-save',
}

const saveCudRows = async () => {
    const rtn = await hui.message().save('데이터를 저장하시겠습니까?')
    if (rtn) {
        await callGridApi('cud', gridCudApi)

        // TODO 데이터 수정 후에 해야하는 작업
        const propsData = confProps?.data
        await loadInitialGridData(gridApi?.read, propsData)
    }
}

// ------------- RealGrid 설정 및 변환 ----------------
let realGridDataProvider: LocalDataProvider
let realGridView: GridView

const _dataProvider = new LocalDataProvider(false)
let _gridView: any

// status bar 조절 여부
RealGrid.setDefault({
    stateBar: {
        visible: gridEditable,
    },
})

const convertToRealGridColumnsInfo = async (_propsColumn: Array<htype.IGridColumn>) => {
    const _fields: CellIndex[] = []
    const _columns: DataColumn[] = []
    // const columeEditConfig = ref<any>() // why ref??

    if (_propsColumn.length > 0) {
        for (const item of _propsColumn) {
            const columnStyleConfig = getRealColumnStyleConfig(item)
            const columnEditConfig = await getRealColumnEditConfig(item.editor)

            const columnItem: DataColumn = {
                fieldName: item.field,
                header: {
                    text: hlang(item.text ?? item.field),
                },
                ...columnEditConfig,
                ...columnStyleConfig,
            }
            if (item.width) {
                columnItem.width = item.width
            }

            _columns.push(columnItem)
            _fields.push({
                fieldName: item.field,
            })
        }
    }

    return { _fields, _columns }
}

const initRealGridView = (_gridTargetDiv: any, _columns: any) => {
    _gridView = new GridView(_gridTargetDiv)
    _gridView.setColumns(_columns)

    // <https://docs.realgrid.com/guides/tip/recommended-options>
    _gridView.displayOptions.fitStyle = GridFitStyle.EVEN
    //***소트나 필터링시 새로 추가되거나 편집된 데이터는 그 기준(소트, 필터)에 맞게 재정렬되는데
    //***그것을 방지하고 사용자가 재정렬이나 필터링 하기전까지는 그 위치를 유지하게하고자 할때
    // _gridView.sortMode = 'explicit';
    // _gridView.filterMode = 'explicit';
    //편집 가능 그리드
    _gridView.editOptions.editable = gridEditable
    //***편집중에 그리드 외부 영역을 클릭하였을때 commit
    _gridView.editOptions.commitWhenLeave = true
    //탭 키로 컬럼 이동시 마지막 컬럼에 도착하면 다음행의 첫 컬럼으로 포커스 이동
    _gridView.editOptions.crossWhenExitLast = true
    //***셀 버튼 클릭시 onCellButtonClicked()이나 onCellItemClicked()이 기본적으로 발생함.
    //***이외에 추가로 onCellClicked()이 같이 발생하는데 이것을 방지하고 싶을때..
    _gridView.editOptions.exceptDataClickWhenButton = true
    //***셀 편집시 병합되어 있는 셀이 분리되어 보이는 것을 방지하고 싶을때
    _gridView.displayOptions.editItemMerging = true
    //rowState가 'deleted'의 것을 화면에 표시할 것인지의 여부, dataProvider.softDeleting과 조합하여 사용합니다.
    _gridView.hideDeletedRows = false
    //***체크바와 체크바의 head 체크를 동기화
    //***ex)체크바가 모두 체크되었을때 head도 같이 체크
    _gridView.checkBar.syncHeadCheck = true
    //헤더의 높이 설정 방법
    _gridView.header.height = 30
    //그리드 하단의 푸터를 표시하고 싶지 않을때
    _gridView.footer.visible = false
    //행 높이 설정하기
    _gridView.displayOptions.rowHeight = 30
    //사용자가 행 높이 변경가능하게 하기
    //첫행의 맨 앞에서 조절 가능, 모든 행의 높이가 동일하게 변경
    _gridView.displayOptions.rowResizable = true
    //개별 행 높이 조절이 가능하게
    _gridView.displayOptions.eachRowResizable = true
    //행/열 고정하기
    // _gridView.setFixedOptions({rowCount: 1, colCount:2, });
    //***정렬이 유지된체 행 고정하고자 할때
    // _gridView.fixedOptions.exceptFromSorting = false;
    //***숫자 필드에 '1,000'을 붙여넣기 할때 ','문자로 인해 1 만 붙여넣기 될때
    _gridView.pasteOptions.numberChars = [',']

    //**** Events ****//
    _gridView.onCellClicked = function onCellClick(grid: GridBase, cellInfo: any) {
        if (cellInfo.cellType === 'gridEmpty') {
            // grid 외부 클릭시 cellType이 'gridEmpty' 상태가 됩니다.
            _gridView.commit()
            // gridView.commit() 을 해야지 비로소 updated 상태로 변합니다.
            return
        }

        if (!cellInfo.editable) {
            // 해당 로직을 타게 된다면, 왼쪽에 grid edit이 뜨지 않는다.
            return
        }

        _gridView.beginUpdateRow(cellInfo.itemIndex)
        _gridView.showEditor()
        _gridView.setFocus()
    }

    _gridView.onCellDblClicked = onCellDblClicked

    return _gridView
}

const initRealGridDataProvider = (_fields: DataFieldInput[]) => {
    _dataProvider.softDeleting = false
    _dataProvider.setFields(_fields)
    return _dataProvider
}

const initRealGrid = (_gridTargetDiv: any, _realGridColumnsInfo: { _fields: DataFieldInput[]; _columns: DataColumn[] }) => {
    realGridDataProvider = initRealGridDataProvider(_realGridColumnsInfo._fields)
    realGridView = initRealGridView(_gridTargetDiv, _realGridColumnsInfo._columns)
    realGridView.setDataSource(realGridDataProvider)

    huiGrid.setRealGrid(realGridView, realGridDataProvider)
}

const getRealColumnStyleConfig = (_column: htype.IGridColumn) => {
    let columnAlignment: string = ''
    if (_column.alignment) {
        columnAlignment = _column.alignment === 'right' ? 'grid_text_alignment_right' : 'grid_text_alignment_left'
    }

    return { styleName: columnAlignment }
}

const getRealColumnEditConfig = async (_columnEditor?: htype.IGridEditor) => {
    if (!_columnEditor) return { editable: false }

    let columnEditConfig

    if (_columnEditor.type === 'input-select') {
        columnEditConfig = await getRealSelectboxConfig(_columnEditor)
    } else if (_columnEditor.type === 'input-check') {
        columnEditConfig = getRealCheckboxConfig(_columnEditor)
    } else if (_columnEditor.type === 'input-number') {
        columnEditConfig = getRealNumberConfig(_columnEditor)
    } else if (_columnEditor.type === 'input-date') {
        columnEditConfig = getRealDateConfig(_columnEditor)
    }
    return columnEditConfig
}

const initSelectbox = async (url: string, params: any) => {
    const { data } = await hdata.post(url, params)
    return data
}

const getGridSelectBoxList = async (_columnEditor: htype.IGridEditor) => {
    if (!_columnEditor) return

    const selectboxList = ref<any[]>([])

    const label = ref<string[]>([])
    const value = ref<string[] | number[]>([])

    if (_columnEditor.api) {
        selectboxList.value = await initSelectbox(_columnEditor.api.url, _columnEditor.api.params)
    } else {
        selectboxList.value = _columnEditor.data ?? []
    }

    selectboxList.value.forEach((select, index) => {
        label.value[index] = select[_columnEditor?.textField ?? 'CODE_NM']
        value.value[index] = select[_columnEditor?.valueField ?? 'CODE_CD']
    })

    return { label: label.value, value: value.value }
}

// ?? rendering 이후 selectbox data 넣는 방법 문의 좀
const getRealSelectboxConfig = async (_columnEditor: htype.IGridEditor) => {
    const editor = {
        type: 'dropdown',
        dropDownCount: 4,
        domainOnly: true,
        textReadOnly: true,
    }

    const selectList = ref<any>()
    selectList.value = await getGridSelectBoxList(_columnEditor)

    return { editor: editor, labels: selectList.value?.label, values: selectList.value?.value, lookupDisplay: true }
}

const getRealCheckboxConfig = (_columnEditor: htype.IGridEditor) => {
    let editable = _columnEditor.type ? true : false
    let readOnly = false

    if (_columnEditor.type === 'input-check') {
        editable = false
        readOnly = false
    }

    const checkboxRenderer = {
        type: 'check',
        trueValues: 'Y',
        falseValues: 'N',
    }

    return { editable: editable, readOnly: readOnly, renderer: checkboxRenderer }
}

const getRealNumberConfig = (_columnEditor: htype.IGridEditor) => {
    const type = 'number'
    let editFormat = '0,000'

    if (_columnEditor?.format) {
        editFormat = _columnEditor?.format
    }

    const editor = {
        type: type,
        editFormat: editFormat,
    }

    return { editor: editor }
}

const getRealDateConfig = (_columnEditor: htype.IGridEditor) => {
    const textFormat = _columnEditor?.textFormat ?? 'yyyy-MM-dd'
    const valueFormat = _columnEditor?.valueFormat ?? 'yyyy-MM-dd'

    const editor = {
        type: 'date',
        datetimeFormat: valueFormat,
        commitOnSelect: true,
    }

    return { editor: editor, textFormat: setDateRegex(valueFormat, textFormat) }
}

const setDateRegex = (valueFormat: string, textFormat: string): string => {
    const value = getConjunctionDate(valueFormat)
    const text = getConjunctionDate(textFormat)

    return `([0-9]{4})${value.yearMonth}([0-9]{2})${value.monthDay}([0-9]{2})$;$1${text.yearMonth}$2${text.monthDay}$3`
}

const getConjunctionDate = (date: string) => {
    let yearMonth = ''
    let monthDay = ''

    if (date.length === 10) {
        yearMonth = date[4]
        monthDay = date[7]
        return { yearMonth, monthDay }
    }
    return { yearMonth, monthDay }
}

// ------------- rendering ----------------
const gridTargetDiv = ref(null)

onMounted(async () => {
    const propsColumns = confProps.columns

    const realGridColumnsInfo = await convertToRealGridColumnsInfo(propsColumns)

    initRealGrid(gridTargetDiv.value, realGridColumnsInfo)
    addEventsOnGrid()

    if (gridAutoLoad) {
        const propsData = confProps?.data
        await loadInitialGridData(gridApi?.read, propsData)
    }
})
</script>
<style lang="scss">
@use './grid.scss';
</style>

```

`HGrid/type.ts`

```tsx
export interface IGridUi {
    type: string
    name: string
    title?: string
    height?: string
    width?: string
    columns: Array<IGridColumn>
    editable?: boolean
    autoLoad?: boolean
    api?: IGridAPI
    data?: Array<any>
    event?: {
        click?: string
        doubleClicked?: string
        dataLoaded?: string
    }
    toolbar?: {
        items?: Array<any>
    }
    showTotalCount?: boolean
    useLayoutManager?: boolean
}

export interface IGridColumn {
    field: string
    text?: string
    width?: number
    flex?: number
    type?: string
    alignment?: string
    editor?: IGridEditor
}

export interface IGridEditor extends IGridEditorCheckBox, IGridEditorSelectBox, IGridEditorNumber, IGridEditorDate {
    type?: htype.GRID_EDITOR_TYPE
    name?: string
}

interface IGridAPI {
    read?: IGridCRUDApi
    cud?: {
        showSaveButton?: boolean
        serviceId?: string
        url?: string
        callback?: string
        create?: IGridCRUDApi
        update?: IGridCRUDApi
        delete?: IGridCRUDApi
    }
}

interface IGridCRUDApi {
    serviceId?: string
    url?: string
    params?: any
    callback?: string
}

interface IGridEditorNumber {
    format?: string
}

interface IGridEditorCheckBox {
    checked?: string
    unChecked?: string
}
interface IGridEditorSelectBox {
    textField?: string
    valueField?: string
    data?: Array<any>
    api?: {
        url: string
        params?: any
    }
}

interface IGridEditorDate {
    textFormat: string
    valueFormat: string
}

```

`hcore/types/objectType.ts`

```jsx
type CHART_TYPE = 'bar' | 'line' | 'pie'
type GRID_EDITOR_TYPE = 'input-text' | 'input-number' | 'input-date' | 'input-select' | 'input-check'

export type { CHART_TYPE, GRID_EDITOR_TYPE }

```

`config/grid/basic.js`

```jsx
const pcd = 'devgrid'
const gridName = 'testGrid'

const view = {
    title: 'Grid 기본',
    pcd: pcd,
    items: [
        {
            type: 'grid',
            title: '목록',
            name: gridName,
            editable: true,
            toolbar: {
                items: [
                    {
                        type: 'button',
                        text: '행추가',
                        event: {
                            click: 'handleClickAddRow',
                        },
                    },
                    {
                        type: 'button',
                        text: '행삭제',
                        event: {
                            click: 'handleClickDeleteRow',
                        },
                    },
                    {
                        type: 'button',
                        text: '수정된 데이터 가져오기',
                        event: {
                            click: 'handleClickGetCUDRows',
                        },
                    },
                ],
            },
            columns: [
                {
                    text: 'ID-1',
                    field: 'DATA_ID1',
                    width: 80,
                    editor: {
                        type: 'input-text',
                    },
                },
                {
                    text: 'ID-2',
                    field: 'DATA_ID2',
                    width: 80,
                    editor: {
                        type: 'input-text',
                    },
                },
                {
                    text: '문자열',
                    field: 'DATA_STRING',
                    width: 150,
                    editor: {
                        type: 'input-text',
                    },
                },
                {
                    text: '소수',
                    field: 'DATA_DECIMAL',
                    width: 80,
                    editor: {
                        type: 'input-number',
                        format: '#,##0.##',
                    },
                    alignment: 'right',
                },
                {
                    text: '정수',
                    field: 'DATA_INTEGER',
                    editor: {
                        type: 'input-number',
                    },
                    width: 80,
                },
                {
                    text: '체크 박스',
                    field: 'DATA_CHAR',
                    width: 50,
                    editor: {
                        type: 'input-check',
                    },
                },
                {
                    text: '선택',
                    field: 'DATA_CODE',
                    width: 150,
                    editor: {
                        type: 'input-select',
                        api: {
                            url: '/api/admin/code/code-grp',
                        },
                        textField: 'CODE_GRP_NM',
                        valueField: 'CODE_GRP_CD',
                    },
                },
                {
                    text: '날짜 (ReadOnly)',
                    field: 'DATA_DATE',
                    width: 150,
                },
                {
                    text: '날짜 String',
                    field: 'DATA_DATE_STR',
                    width: 150,
                    editor: {
                        type: 'input-date',
                        textFormat: 'yyyy.MM.dd',
                        valueFormat: 'yyyy-MM-dd',
                    },
                },
            ],
            api: {
                read: {
                    serviceId: 'service-grid-read-sample',
                    params: {},
                },
                cud: {
                    showSaveButton: true,
                    serviceId: 'service-grid-cud-sample',
                },
            },
            event: {
                doubleClicked: 'handleRowDoubleClick',
                // dataLoaded: 'handleDataLoaded',
            },
        },
    ],
}

const page = hui.getPage(pcd)
const grid = page.getGrid(gridName)

const func = {
    handleClosePopupEditProgram: function () {
        reloadGrid()
    },
    handleRowDoubleClick: function (args) {
        console.log('row double click event -> ', args)
    },
    handleChangeTextInput: function (args) {
        console.log('newValue > ', args)
    },
    handleClickAddRow: function () {
        grid.api.addRow()
    },
    handleClickDeleteRow: function () {
        grid.api.deletedRow()
    },
    handleClickGetCUDRows: function () {
        console.log(grid.api.getCUDRows())
    },
}

export { view, func }

function reloadGrid() {
    hui.getPage(pcd).event(gridName).fire('reload-grid-evt')
}

```

`gridSampleColumn.ts`

```jsx
export const sampleRealGridColumn = [
    {
        name: 'TestId',
        fieldName: 'id',
        width: '70',
        dataType: 'Number',
        editable: false,
        header: {
            text: 'id',
        },
    },
    {
        name: 'TextEditor',
        fieldName: 'TextEditor',
        width: '70',
        dataType: 'text',
        header: {
            text: 'TextEditor',
        },
    },
    {
        name: 'TextRender',
        fieldName: 'TextRender',
        width: '70',
        dataType: 'text',
        header: {
            text: 'Text Render',
        },
    },
    {
        name: 'TextArea',
        fieldName: 'TextArea',
        width: '70',
        dataType: 'text',
        header: {
            text: 'Text Area',
        },
    },
    {
        name: 'Date',
        fieldName: 'Date',
        header: {
            text: '날짜',
        },
        editor: {
            type: 'date',
            datetimeFormat: 'yyyy-MM-dd',
            commitOnSelect: true,
        },
        textFormat: '([0-9]{4})-([0-9]{2})-([0-9]{2})$;$1$2$3',
    },
    {
        name: 'Time',
        fieldName: 'Time',
        header: {
            text: '날짜 시간',
        },
        width: '150',
        sortable: false,
        editButtonVisibility: 'default',
        editor: {
            type: 'date',
            timeSelectType: 'second', // none/hour/minute/second
            datetimeFormat: 'yyyy-MM-dd ',
        },
        datetimeFormat: 'yyyy/MM/dd ',
    },
    {
        name: 'YearMonth',
        fieldName: 'YearMonth',
        header: {
            text: 'Year/Month',
        },
        editor: {
            type: 'date',
            datetimeFormat: 'yyyy-MM',
            commitOnSelect: true,
            mask: {
                editMask: '9999-99',
                placeHolder: 'yyyy-MM',
                includedFormat: true,
            },
        },
    },
    {
        name: 'Masked',
        fieldName: 'Masked',
        header: {
            text: 'Masked',
        },
    },
    {
        name: 'CheckBox',
        fieldName: 'CheckBox',
        width: '70',
        readOnly: false,
        renderer: {
            type: 'check',
            trueValues: 'Y',
            falseValues: 'N',
        },
        editable: false,
        header: {
            text: '사용',
            styleName: 'orange-column',
        },
    },
    {
        name: 'CHKEditor',
        fieldName: 'CHKEditor',
        width: '70',
        header: {
            text: 'CHK Editor',
        },
    },
    {
        name: 'Integer',
        fieldName: 'Integer',
        editor: {
            type: 'number',
        },
        header: {
            text: '숫자(정수)',
        },
    },
    {
        name: 'double2',
        fieldName: 'double2',
        editor: {
            type: 'number',
            editFormat: '#,##0.##',
        },
        header: {
            text: '숫자(소수점 2자리)',
        },
    },
    {
        name: 'double3',
        fieldName: 'double3',
        editor: {
            type: 'number',
            editFormat: '#,##0.###',
        },
        header: {
            text: '숫자(소수점 3자리)',
        },
    },
    {
        name: 'GCD',
        fieldName: 'GCD',
        width: 150,
        sortable: true,
        lookupDisplay: true,
        editable: true,
        values: ['Austria', 'Belgium', 'Brazil', 'Finland', 'France', 'Germany', 'Ireland'],
        labels: ['오스트리아', '벨기에', '브라질', '핀란드', '프랑스', '독일', '아일랜드'],
        editor: {
            type: 'dropdown',
            dropDownCount: 4,
            domainOnly: true,
            textReadOnly: true,
        },
        header: {
            text: '공통 코드 그룹',
            styleName: 'orange-column',
        },
    },
    {
        name: 'LANG',
        fieldName: 'LANG',
        width: 150,
        sortable: true,
        lookupDisplay: true,
        editable: true,
        values: ['en_US', 'ko_KR'],
        labels: ['English', '한국어'],
        editor: {
            type: 'dropdown',
            dropDownCount: 4,
            domainOnly: true,
            textReadOnly: true,
        },
        header: {
            text: '공통 코드 Select',
            styleName: 'orange-column',
        },
    },
    {
        name: 'SELECT_NAME',
        fieldName: 'SELECT_NAME',
        header: {
            text: 'SELECT_NAME',
        },
    },
    {
        name: 'Depart',
        fieldName: 'Depart',
        width: '70',
        values: ['22', '20'],
        labels: ['PNS', '제지'],
        editor: {
            type: 'dropdown',
            dropDownCount: 4,
            domainOnly: true,
            textReadOnly: true,
        },
        header: {
            text: '부서',
        },
    },
    {
        name: 'Button',
        fieldName: 'Button',
        header: {
            text: '버튼',
        },
    },
    {
        name: 'PopUpCode',
        fieldName: 'PopUpCode',
        header: {
            text: '팝업버튼-CODE',
        },
    },
    {
        name: 'Popup',
        fieldName: 'Popup',
        header: {
            text: '팝업',
        },
    },
    {
        name: 'PopupName',
        fieldName: 'PopupName',
        header: {
            text: '팝업버튼-NAME',
        },
    },
    {
        name: 'PopupEditorName',
        fieldName: 'PopupEditorName',
        header: {
            text: '팝업Editor-NAME',
        },
    },
    {
        name: 'PopupEditorCode',
        fieldName: 'PopupEditorCode',
        header: {
            text: '팝업Editor-CODE',
        },
    },
    {
        name: 'download',
        fieldName: 'download',
        header: {
            text: '다운(1건)',
        },
    },
    {
        name: 'upload',
        fieldName: 'upload',
        header: {
            text: '첨부 Pop',
        },
    },
]

export const sampleRealGridLayout = [
    'TestId',
    {
        name: 'TextAndStyle',
        direction: 'horizontal',
        items: ['TextEditor', 'TextRender', 'TextArea'],
        header: {
            text: '텍스트 & Style',
            visible: true,
        },
    },
    {
        name: 'DateArea',
        direction: 'horizontal',
        items: ['Date', 'Time', 'YearMonth', 'Masked'],
        header: {
            text: 'Date',
            visible: true,
        },
    },
    {
        name: 'CheckBoxArea',
        direction: 'horizontal',
        items: ['CheckBox', 'CHKEditor'],
        header: {
            text: '체크박스',
            visible: true,
        },
    },
    {
        name: 'Number',
        direction: 'horizontal',
        items: ['Integer', 'double2', 'double3'],
        header: {
            text: '숫자',
            visible: true,
        },
    },
    {
        name: 'SelectBox',
        direction: 'horizontal',
        items: ['GCD', 'LANG', 'SELECT_NAME', 'Depart'],
        header: {
            text: 'SELECT 콤보',
            visible: true,
        },
    },
    'Button',
    {
        name: 'PopUpArea',
        direction: 'horizontal',
        items: ['PopUpCode', 'Popup', 'PopupName', 'PopupEditorName', 'PopupEditorCode'],
        header: {
            text: 'POPUP',
            visible: true,
        },
    },
    {
        name: 'file',
        direction: 'horizontal',
        items: ['download', 'upload'],
        header: {
            text: '첨부파일',
            visible: true,
        },
    },
]

export const sampleRealGridField = [
    {
        fieldName: 'id',
    },
    {
        fieldName: 'TextEditor',
    },
    {
        fieldName: 'TextRender',
    },
    {
        fieldName: 'TextArea',
    },
    {
        fieldName: 'Date',
    },
    {
        fieldName: 'Time',
    },
    {
        fieldName: 'YearMonth',
    },
    {
        fieldName: 'Masked',
    },
    {
        fieldName: 'CheckBox',
    },
    {
        fieldName: 'CHKEditor',
    },
    {
        fieldName: 'Integer',
    },
    {
        fieldName: 'double2',
    },
    {
        fieldName: 'double3',
    },
    {
        fieldName: 'GCD',
    },
    {
        fieldName: 'LANG',
    },
    {
        fieldName: 'SELECT_NAME',
    },
    {
        fieldName: 'Depart',
    },
    {
        fieldName: 'Button',
    },
    {
        fieldName: 'PopUpCode',
    },
    {
        fieldName: 'Popup',
    },
    {
        fieldName: 'PopupName',
    },
    {
        fieldName: 'PopupEditorName',
    },
    {
        fieldName: 'PopupEditorCode',
    },
    {
        fieldName: 'download',
    },
    {
        fieldName: 'uploade',
    },
]

```

`gridSampleData.ts`

```jsx
const gridCheckBoxSample = [
    {
        id: 0,
        TextEditor: '1번째',
        TextRender: 'Text',
        TextArea: '',
        Date: '2024-05-10',
        Time: '2024-07-17 16:38:07',
        YearMonth: '2024-07',
        Masked: '',
        CheckBox: 'Y',
        CHKEditor: 'Y',
        Integer: 1,
        double2: 1.02,
        double3: 1.023,
        GCD: 'Austria',
        LANG: 'ko_KR',
        SELECT_NAME: '',
        Depart: 22,
        Button: '',
        PopUpCode: '',
        Popup: '',
        PopupName: '',
        PopupEditorName: '',
        PopupEditorCode: '',
        download: '',
        upload: '',
    },
    {
        id: 2,
        TextEditor: '2번째',
        TextRender: 'Text',
        TextArea: '',
        Date: '2024-07-04',
        Time: '2024-07-17 16:38:07',
        YearMonth: '2024-07',
        Masked: '',
        CheckBox: 'Y',
        CHKEditor: 'Y',
        Integer: 1,
        double2: 1.02,
        double3: 1.023,
        GCD: 'Austria',
        LANG: 'ko_KR',
        SELECT_NAME: '',
        Depart: 22,
        Button: '',
        PopUpCode: '',
        Popup: '',
        PopupName: '',
        PopupEditorName: '',
        PopupEditorCode: '',
        download: '',
        upload: '',
    },
    {
        id: 3,
        TextEditor: '3번째',
        TextRender: 'Text',
        TextArea: '',
        Date: '2024-05-04',
        Time: '2024-07-17 16:38:07',
        YearMonth: '2024-07',
        Masked: '',
        CheckBox: 'Y',
        CHKEditor: 'Y',
        Integer: 1,
        double2: 1.02,
        double3: 1.023,
        GCD: 'Austria',
        LANG: 'ko_KR',
        SELECT_NAME: '',
        Depart: 22,
        Button: '',
        PopUpCode: '',
        Popup: '',
        PopupName: '',
        PopupEditorName: '',
        PopupEditorCode: '',
        download: '',
        upload: '',
    },
]

export { gridCheckBoxSample }

```

`sample/grid/realgrid.vue`

```jsx
<template>
    <div class="contentPaddingBox h100p flex flex_d_c">
        <div class="flex flex_d_c h100p gap12">
            <div class="topTitleArea">
                <div class="leftArea">
                    <h2 class="h2title">RealGrid Sample</h2>
                </div>
                <div class="rightArea">
                    <HButton :conf="btnAddRow" @click="addCreatedRow"></HButton>
                    <HButton :conf="btnRemoveRow" @click="deletedRow"></HButton>
                    <HButton :conf="saveBtn" @click="getCUDRows"></HButton>
                    <HButton :conf="btnRefreshSelectBox" @click="refreshSelectBoxColumn"></HButton>
                    <HButton :conf="btnCopyRow" @click="refreshSelectBoxColumn"></HButton>
                </div>
            </div>
            <slot name="gridTest"></slot>
            <div ref="realgridTarget" data-type="RealGrid" class="h100p"></div>
        </div>
    </div>
</template>

<script setup lang="ts">
interface IGridSample {
    id?: number
    textEditor?: string
    isCheck?: string
    checkRender?: string
    NationID?: string
    MultiLine?: string
}

const saveBtn = {
    text: '수정된 데이터 가져오기',
}

const btnAddRow = {
    text: '행추가',
    fontIcon: 'mdi mdi-plus-box-outline',
}

const btnRemoveRow = {
    text: '행삭제',
    fontIcon: 'mdi mdi-minus-box-outline',
}

const btnRefreshSelectBox = {
    text: '그리드 새로고침',
    fontIcon: 'mdi mdi-refresh',
}

const btnCopyRow = {
    text: '복사',
    fontIcon: 'mdi mdi-content-copy',
}

import { RowState, GridView, LocalDataProvider, GridFitStyle } from 'realgrid'
import type { CellIndex, DataFieldInput, DataColumn, GridBase } from 'realgrid'

import { gridCheckBoxSample } from './gridSampleData'
import { sampleRealGridColumn, sampleRealGridField, sampleRealGridLayout } from './gridSampleColumn'
import { initGrid } from './gridConfig'

const realgridTarget = ref(null)

const _dataProvider = new LocalDataProvider(false)
let _gridView: GridView

let realGridDataProvider: LocalDataProvider
let realGridView: GridView

function addCreatedRow() {
    realGridView.cancel()
    _dataProvider.insertRow(0, [])
    // gridView.setCurrent({ dataRow: dataRow }) //추가된 행으로 포커스 이동
    //setTimeout(function(){gridView.showEditor();}, 10); //바로 편집기를 표시하고 싶을때
}
function deletedRow() {
    realGridView.cancel()
    const selectRows = realGridView.getCheckedItems()
    const createdRows = _dataProvider.getStateRows(RowState.CREATED)

    setDivisionCreateAndExistRows(selectRows, createdRows)

    // realGridDataProvider.removeRows(createdAndSelectRowIndex)
    // realGridDataProvider.setRowStates(existSelectRowIndex, RowState.DELETED, true)
}

function setDivisionCreateAndExistRows(selectRows: number[], createRows: number[]) {
    const createdAndSelectRowIndex: number[] = []

    selectRows.map((row: number) => {
        if (createRows.includes(row)) {
            createdAndSelectRowIndex.push(row)
        } else {
            _dataProvider.setRowState(row, RowState.DELETED, true)
        }
    })

    _dataProvider.removeRows(createdAndSelectRowIndex)
}

function getCUDRows() {
    const rows = _dataProvider.getAllStateRows()

    const createdRows = setCreatedRows(rows?.created)
    const updatedRows = setUpdatedRows(rows?.updated)
    const deletedRows = setDeletedRows(rows?.deleted)

    const result = convertGridFormat(createdRows, updatedRows, deletedRows)

    console.log(result)
}

function setCreatedRows(created: number[] = []) {
    const createdRows: any[] = []
    let i = 0
    if (created) {
        created.map((row: any) => {
            const pRow = _dataProvider.getJsonRows(row, row)
            createdRows[i] = pRow[0]
            i++
        })
    }

    return createdRows
}

function setUpdatedRows(updated: number[] = []) {
    const updatedRows: any[] = []
    let i = 0
    if (updated) {
        updated.map((row: any) => {
            const pRow = _dataProvider.getJsonRows(row, row)
            updatedRows[i] = pRow[0]
            i++
        })
    }

    return updatedRows
}

function setDeletedRows(deleted: number[] = []) {
    const deletedRows: any[] = []
    let i = 0

    if (deleted) {
        deleted.map((row: any) => {
            const pRow = _dataProvider.getJsonRows(row, row)
            deletedRows[i] = pRow[0]
            i++
        })
    }

    return deletedRows
}

function convertGridFormat(created: any[], updated: any[], deleted: any[]) {
    return {
        C: created,
        U: updated,
        D: deleted,
    }
}

// 렌더링 이후에 특정 컬럼의 속성을 변경하는 함수
const refreshSelectBoxColumn = () => {
    realGridView.setColumnProperty('NationID', 'values', ['Italy', 'Mexico', 'Spain', 'Sweden', 'Switzerland', 'UK', 'USA', 'Venezuela'])
    realGridView.setColumnProperty('NationID', 'labels', ['이탈리아', '멕시코', '스페인', '스웨덴', '스위스', '영국', '미국', '베네수엘라'])
}

const initRealGridDataProvider = (_fields: DataFieldInput[]) => {
    _dataProvider.softDeleting = false
    _dataProvider.setFields(_fields)
    return _dataProvider
}

const initRealGrid = (_gridTargetDiv: any, _fields: DataFieldInput[], _columns: any, _layout: any) => {
    realGridDataProvider = initRealGridDataProvider(_fields)

    realGridView = initGrid(_gridTargetDiv, _columns, _layout)

    realGridView.setDataSource(realGridDataProvider)
}

onMounted(() => {
    initRealGrid(realgridTarget.value, sampleRealGridField, sampleRealGridColumn, sampleRealGridLayout)

    realGridDataProvider.fillJsonData(gridCheckBoxSample)
})
</script>

```