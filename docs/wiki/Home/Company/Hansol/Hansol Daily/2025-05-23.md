---
시작 날짜: 2025-05-23
종료 날짜: 2025-05-23
분류: 노트
카테고리:
  - Application
특징:
  - Front
  - Nuxt3
sticker: emoji//1f4c6

slug: "2025-05-23"
---

# 할일
- [ ] 예전에 Configuraiton으로 받았던 함수들의 이벤트를 어디서 처리를 제어할 것인지
	- [ ] 사용자가 원해서 사용하는 부분, default 동작이 필요한 부분으로 나누기
- [ ] default 속성이 overwriting이 되는지 확인 필요



# Nuxt Extends 기능
Nuxt 3의 layer 기능을 Git remote 주소 방식으로 사용하는 것은 매우 강력한 기능이며, 여러 프로젝트에서 공통된 기능이나 UI를 재사용할 때 유용합니다.

### Git remote 주소 방식으로 `extends` 사용 방법

`nuxt.config.ts` 파일에서 `extends` 옵션을 사용하여 Git remote 주소를 지정할 수 있습니다.

**기본 형식:**

TypeScript

```
export default defineNuxtConfig({
  extends: [
    'github:username/repoName', // GitHub 리포지토리
    'github:username/repoName/base', // 리포지토리 내 특정 디렉토리
    'github:username/repoName#dev', // 특정 브랜치
    'github:username/repoName#v1.0.0', // 특정 태그
  ]
})
```

**예시:**

만약 `my-org/my-nuxt-layer`라는 GitHub 리포지토리에 공유하고 싶은 Nuxt 레이어가 있다면 다음과 같이 사용할 수 있습니다.

TypeScript

```
// nuxt.config.ts (메인 Nuxt 프로젝트)
export default defineNuxtConfig({
  extends: [
    'github:my-org/my-nuxt-layer'
  ]
})
```

**개인(Private) 리포지토리 사용 시:**

개인 리포지토리를 사용하려면 `GIGET_AUTH` 환경 변수에 GitHub Personal Access Token (PAT)을 설정해야 합니다.

Bash

```
# .env 파일 또는 CI/CD 환경 변수
GIGET_AUTH=your_github_personal_access_token
```

그리고 `extends` 옵션에서 `auth` 옵션을 함께 전달할 수 있습니다.

TypeScript

```
// nuxt.config.ts
export default defineNuxtConfig({
  extends: [
    ['github:my-org/my-private-nuxt-layer', { auth: process.env.GIGET_AUTH }]
  ]
})
```

**GitLab 또는 Self-hosted Git 인스턴스 사용 시:**

`GIGET_GITHUB_URL` 또는 `GIGET_GITLAB_URL` 환경 변수를 사용하여 해당 인스턴스의 URL을 지정할 수 있습니다.

### `node_modules` 존재 여부 및 설치

**결론부터 말씀드리면, Git remote 주소로 `extends` 기능을 사용할 때, 원격 리포지토리(Layer) 자체에 `node_modules`가 존재할 필요는 없습니다.**

Nuxt는 Git remote layer를 가져올 때 `unjs/giget`를 사용하여 해당 리포지토리의 스냅샷을 다운로드합니다. 이 때, 기본적으로 `node_modules`는 다운로드되지 않습니다.

**하지만, 원격 레이어가 자체적인 npm 의존성을 가지고 있고, 해당 의존성을 메인 Nuxt 프로젝트에서 설치하여 사용해야 하는 경우가 있습니다.** 이 때 `install: true` 옵션을 사용합니다.

TypeScript

```
// nuxt.config.ts
export default defineNuxtConfig({
  extends: [
    ['github:username/repoName', { install: true }]
  ]
})
```

`install: true` 옵션을 사용하면, Nuxt는 원격 레이어의 `package.json` 파일을 확인하고 필요한 의존성을 메인 Nuxt 프로젝트의 `node_modules`에 설치하려고 시도합니다. 이는 Nuxt가 해당 레이어를 로컬 프로젝트의 `node_modules` 내부의 임시 디렉토리에 다운로드한 후, 해당 레이어의 의존성을 설치하는 방식으로 작동합니다.

**주의할 점:**

- **의존성 충돌:** 메인 프로젝트와 레이어 간에 의존성 버전 충돌이 발생할 수 있습니다. SemVer를 잘 활용하고, 필요한 경우 Yarn Workspaces나 pnpm Workspaces와 같은 Monorepo 솔루션을 고려해볼 수 있습니다.
- **성능:** `install: true`를 사용할 경우, Nuxt 빌드 시점에 원격 리포지토리를 다운로드하고 의존성을 설치하는 과정이 추가되어 빌드 시간이 다소 늘어날 수 있습니다.
- **환경 변수:** 개인 리포지토리를 사용하는 경우 `GIGET_AUTH`와 같은 환경 변수를 빌드 환경에 정확히 설정해야 합니다.

**요약:**

Nuxt 3의 `extends` 기능을 Git remote 주소로 사용하는 것은 매우 편리하며, `install: true` 옵션을 통해 원격 레이어의 의존성까지 관리할 수 있습니다. `node_modules`는 원격 리포토리 자체에 존재할 필요는 없지만, `install: true`를 통해 메인 프로젝트에서 레이어의 의존성을 설치하여 사용할 수 있습니다.


네, 가능합니다. Nuxt 3의 `extends` 기능은 단일 Git 리포지토리 내에서 특정 서브 디렉토리를 지정하여 레이어처럼 사용할 수 있도록 지원합니다. 이는 모노레포 구조에서 특히 유용합니다.

### 모노레포 구조에서 디렉토리로 나눠서 `extends` 사용 방법

만약 Git 리포지토리 구조가 다음과 같다고 가정해 봅시다:

```
my-mono-repo/
├── nuxt-ui/
│   ├── nuxt.config.ts
│   ├── package.json
│   └── ... (컴포넌트, 플러그인 등)
├── nuxt-utils/
│   ├── nuxt.config.ts
│   ├── package.json
│   └── ... (유틸리티 함수, 모듈 등)
└── package.json (루트 워크스페이스용)
```

이러한 구조에서 `nuxt-ui`와 `nuxt-utils`를 각각 별도의 Nuxt 레이어로 사용하고 싶다면, `extends` 옵션에서 다음과 같이 경로를 지정할 수 있습니다.

TypeScript

```
// nuxt.config.ts (메인 Nuxt 프로젝트)
export default defineNuxtConfig({
  extends: [
    'github:my-org/my-mono-repo/nuxt-ui',   // nuxt-ui 디렉토리를 레이어로 사용
    'github:my-org/my-mono-repo/nuxt-utils', // nuxt-utils 디렉토리를 레이어로 사용
  ]
})
```

**설명:**

- `github:my-org/my-mono-repo/nuxt-ui`: `my-org` 계정의 `my-mono-repo` 리포지토리 내에서 `nuxt-ui` 디렉토리를 Nuxt 레이어로 가져옵니다. Nuxt는 이 디렉토리 안에 있는 `nuxt.config.ts`를 해당 레이어의 설정으로 인식합니다.
- `github:my-org/my-mono-repo/nuxt-utils`: 마찬가지로 `my-mono-repo` 리포지토리 내의 `nuxt-utils` 디렉토리를 또 다른 Nuxt 레이어로 가져옵니다.

### `install: true` 옵션과 `node_modules`

이 경우에도 마찬가지로, 각 서브 디렉토리(레이어)에 자체적인 `package.json` 파일이 있고, 해당 레이어가 의존성을 가지고 있다면 `install: true` 옵션을 함께 사용해야 합니다.

TypeScript

```
// nuxt.config.ts (메인 Nuxt 프로젝트)
export default defineNuxtConfig({
  extends: [
    ['github:my-org/my-mono-repo/nuxt-ui', { install: true }],
    ['github:my-org/my-mono-repo/nuxt-utils', { install: true }],
  ]
})
```

이렇게 하면 Nuxt는 각각의 레이어를 다운로드한 후, 해당 레이어 디렉토리 내의 `package.json`을 기반으로 의존성을 설치하게 됩니다.

### 장점

- **코드 재사용:** 모노레포 내에서 공통 컴포넌트, 유틸리티, 로직 등을 여러 Nuxt 프로젝트에서 쉽게 공유하고 재사용할 수 있습니다.
- **단일 Git 리포지토리:** 관련된 모든 레이어를 하나의 Git 리포지토리에서 관리할 수 있어 버전 관리 및 배포가 용이합니다.
- **유연성:** 특정 레이어만 선택적으로 가져오거나, 필요에 따라 여러 레이어를 조합하여 사용할 수 있습니다.

### 고려사항

- **경로 정확성:** Git 리포지토리 내의 서브 디렉토리 경로를 정확하게 지정해야 합니다.
- **의존성 관리:** 여러 레이어 간의 의존성 충돌에 주의해야 합니다. Monorepo 관리 도구(예: Yarn Workspaces, pnpm Workspaces, Nx 등)를 사용하여 의존성 호이스팅(hoisting) 및 관리를 더 효율적으로 할 수도 있습니다. 하지만 Nuxt `extends` 자체는 해당 도구에 종속되지 않습니다.
- **빌드 시간:** 여러 레이어를 가져오고 각 레이어의 의존성을 설치해야 하므로, 빌드 시간이 다소 증가할 수 있습니다.

이 기능을 활용하면 모노레포 환경에서 Nuxt 프로젝트들을 효과적으로 관리하고, 코드 재사용성을 극대화할 수 있습니다.


