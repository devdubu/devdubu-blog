---
sticker: emoji//1f4c6
종료 날짜: 2025-02-05
시작 날짜: 2025-02-05
분류: 출장 - HD Electric
카테고리:
  - Application
특징:
  - Front
  - Vue3
---
# 발전기

## 기본 성적서 화면 분석

발전기 기본 성적서 조회 URL

- `/wc06/qc/qc03001/SearchDataPjt`

**AVR Setting** 팝업이 데이터가 없다고 안들어가짐 & 하단 값들이 없는 `POSTID`

```json
{
	"IN_POSTID" : "20210395RAH008"
}
```

**특이사항**

- `wc06/qc/qc03001/SearchData` API 값이 없음
    - 실제 DB 상에서 데이터가 없음

**AVR Setting** 팝업이 들어가짐 & 하단 값들이 채워진 `POSTID`

```json
{
	"IN_POSTID" : "20210079RAL006"
}
```

**특이사항**

- `wc06/qc/qc03001/SearchData` API 값이 존재
    - 실제로 값이 2개가 존재함,, `SERNO` 로 정렬을 통해서 데이터를 뱉어줌

해당 화면에서 `SearchData` 쪽에 데이터가 없다면, 왼쪽 화면의 데이터를 입력을 하여서 `SERNO`로 저장하는 형태인가?

성적서 안 데이터 입력 후 → 저장

그 후에 **AVR Setting 팝업에 접근 가능**

기본적으로 모든 칸을 다 넣어야 하고, 해당 칸마다 계산 식이 얼만큼 이어져 있는지 확인 필요함

### 화면 특징

우선 상세 정보 데이터가 있거나 없거나로 크게 나뉜다.

**상세 정보 데이터가 있을 때**

- `Txt_UPERSENT` 라는 데이터(Load Test에 U%) 라는 컴포넌트의 계산 식을 적용하지 않고, 그대로 값을 넣어 놓는다. → 이외 모든 데이터 값들은 모두 바인딩 처리
- `SERNO`
    - 3자리 미만이면 ⇒ 001
    - 3자리 이상이면 ⇒ 그대로 출력
- **Hight Voltage Test** 에 `HIGHTSTTV` 의 값이 `''` 일 때
- `m_SelectedData["HIGHSTTV"].ToString() == ""` 일 때

```csharp
decimal Volt = decimal.Parse(Txt_V.EditValue.ToString());
Cbo_STTV.EditValue = (Volt * 2) + 1000

Root.WdxSetBindingNestedControl(m_SelectedData);
if(m_SelectedData["A"].toString() == ""){
	Txt_A.EditValue = DtData.Rows[0]["A"].ToString();
}
```

위 코드에 대한 전반적인 설명

A가 DB를 의미하는지, 다른 걸 의미하는지 확인 필요

**저장 버튼 클릭**

- 필수 입력 항목 체크
    - `SERNO` , `TESTID` 값은 **공백 X**
- **저장 여부 확인**하고 진행
- 화면 컴포넌트의 값이 **공백**이면 **0**으로 변환해서 저장함
- 파라미터 값 중 `IRSHTV`, `IRRTTV` , `IRSTTV` , `IRETDTV` 필드 값이 Emtpy 이면 0으로 설정한다.
- 저장이 정상적으로 완료 되면, 해당 조회 조건으로 조회 후 화면에 표시한다.

**삭제 버튼 클릭**

- 삭제 여부 확인 후 진행
- 삭제 진행 후 화면 조회 다시 진행

**엑셀 출력 버튼 이벤트**

### AVR Setting 팝업 조회 버튼 클릭

- `Project No`, `Ser No`, `Test ID` 모두 입력해주세요
    - 위 알림처럼, 해당 데이터 값들이 입력되어야 한다.
- 입력된 `Project No`, `Ser No`, `Test ID` 정보로 조회 시 데이터가 없으면,
    - 기본성적서 자료가 없습니다.
    - 알림을 띄워야한다.
- 데이터가 있다면, AVR Setting 팝업 화면 실행
    - `wc06/qc/qc03001/SearchData` url로 데이터 받아옴
- **저장 버튼 클릭**
    - 필수 입력 항목 체크
    - 저장 여부 확인
    - `Ser No`, `Test ID` 값은 공백으로 입력되어 있으면 안됨
    - 위 조건에 맞으면 저장
        - 저장이 정상적으로 완료 되면 조회 조건으로 다시 로딩
- **삭제 버튼 클릭**
    - 삭제 여부 확인 후 진행
    - 정상적으로 삭제 될 시, 팝업 종류

### 계산식

#### 대상 항목
:::tip `Txt_VoltUV` , `Txt_VoltVW` , `Txt_VoltWU` , `Txt_UVST`, `Txt_VWST`, `Txt_WUST`

:::

```js
if(Txt_VoltUV && Txt_VoltVW && Txt_VoltWU && Txt_UVST && Txt_VWST && Txt_WUS){ 
	const uv = Txt_VoltUV 
	const vw = Txt_VoltVW 
	const wu = Txt_VoltWU 
	let avg = Math.round((uv + vw + wu)/3) 
	// 해당 부분은 JS는 정확하지 않다. 6자리; 반올림

	const Txt_AVGST = avg

	let NM = []
	
	// 해당 부분도 부동 소수점 때문에 정확하지 않을 수도 있음
	ABSUV = (Math.abs(uv - avg)/avg) * 100 
	ABSVW = (Math.abs(vw - avg)/avg) * 100 
	ABSWU = (Math.abs(wu - avg)/avg) * 100 


	NM = [ABSUV, ABSVW , ABSWU]

	let max = ABSUV
	NM.map((nm)=>{
		
		if(nm>max){
			max = nm
		}
		Txt_MaxST = Math.round(max) // 1의 자리에서 반올림
	})
}else{
	Txt_MaxST = ''
	Txt_AVGST = ''
}

if()
```

:::tip `Txt_CosPersent1` ~ `Txt_CosPercent5`, `Txt_Volt1` ~ `Txt_Volt5`

:::

```js
const CUA1 = Txt_CUA1 ?? 0
const CUA2 = Txt_CUA2 ?? 0
const CUA3 = Txt_CUA3 ?? 0
const CUA4 = Txt_CUA4 ?? 0
const CUA5 = Txt_CUA5 ?? 0

const CurrentA = Txt_A ?? 0

const cosP1 = Txt_CosPersent1 ?? ""
const cosP2 = Txt_CosPersent2 ?? ""
const cosP3 = Txt_CosPersent3 ?? ""
const cosP4 = Txt_CosPersent4 ?? ""
const cosP5 = Txt_CosPersent5 ?? ""

if(CUA1 && CurrentA){
	Txt_CosParent1 = (CUA1 / CurrentA)* 100 // double 계산 
}else{
	Txt_CosParent1 = ''
}

if(CUA2 && CurrentA){
	Txt_CosParent2 = (CUA2 / CurrentA)* 100 // double 계산 
}else{
	Txt_CosParent2 = ''
}
// 5번까지 반복
... 
```

:::tip `Txt_SPCD`, `Txt_CURCD`

:::

```js
const CurrentA = Txt_A ?? ''
const Condition = Txt_CURCD ?? 0
const SpeedCd = Txt_SPCD ?? 0
const RPM = Txt_rpm ?? 0

if(CurrentA && Condtion){
	Txt_CURTV = Math.round((CurrentA * Condtion)/ 100) // 1의 자리에서 반올림
}else{
	Txt_CURTV = 0
}

if(SpeedCd && RPM ){
	Txt_SPTV = (SpeedCd * RPM) / 100 // double Type
}else{
	Txt_SPTV = 0
}
```

:::tip `Txt_ATWT`, `Txt_ATBT`, `Txt_ATAT`

:::

`Cbo` 값은 select box 의 값임, 해당 값은 select box 가 change 되면 덮어씌워주면 됨

```js
Txt_ATWT = Cbo_ATWT

Txt_ATBT = Cbo_ATBT

Txt_ATAT = Cbo_ATAT
```

## 엑셀 출력
