---
sticker: emoji//1f4c6
종료 날짜: 2024-11-04
시작 날짜: 2024-11-04
분류: 노트
카테고리:
  - Application
특징:
  - Front
  - Nuxt3
  - Test
---
# FE 테스트 현황

- 현재는 주된 로직 테스트만 진행 중
- 최대한 Export 수를 줄인 채로 테스트를 진행하려고 함

# Grid 테스트 현황

각 디렉토리를 나눈 후에, 모든 디렉토에서 index.spec.ts 로 테스트를 진행하고 있습니다.

![image-5.png](/img/이미지 창고/image-5.png)

최대한 export 수를 줄이고, 해당 디렉토리 내부에서만 사용하는 로직들이 많아서, 불필요한 외부 반출을 줄이려고 시도 했으나,,실패

정확히는 **함수형**과 **객체형** export는 **protected** 는 **불가능**

> 문제점 1

외부 자료에 의하면 중요한 로직들만 테스트 해도 충분하다고 여기지만, 해당 로직이 중요하다는 판단은 어떤 식으로 내려야 하는 지에 대한 의문이 생기게 됐습니다.

만약 중요 로직이라면, 불필요한 export를 해야하는지?

vitest.spyOn() 이라는 함수를 이용하려고 했으나, 실패

우선적으로 가능하다고는 하나,, 매개변수가 없는 함수는 가능함이 확인이 되지만, 매개변수가 있는 함수는 실패

> 문제점 2

Grid에 종속적인 주요 로직 들은 테스트가 어렵거나 매우 번거롭다

### 매개변수에 대한 정확한 타입을 지정하면서, 그에 대한 객체 또한 정확하게 가짜로 만들어야 하는 번거로움

```tsx
// HGrid/realGridConfig/event/index.ts
...
realGridView.onCellDblClicked = gridEvent.click.dobule // 해당 부분은 RealGrid 자체적으로 함수로 처리
...

// HGrid/realGridConfig/event/gridClickEventConfig.ts

...
  const click = {
    dobule: (grid: GridBase, cellInfo: any) => {
      if (cellInfo.cellType === 'gridEmpty') return
      if (gridEvent?.doubleClick) {
        const clickData = realGridProvider.getJsonRow(cellInfo.dataRow)
        huiPage.func().call(gridEvent.doubleClick, returnHGridCellInfo(cellInfo), clickData)
      }
      if (gridEvent?.doubleClicked) {
        const clickData = realGridProvider.getJsonRow(cellInfo.dataRow)
        huiPage.func().call(gridEvent.doubleClicked, clickData)
        }
      },
      ...
  }
...

```

위 예시는 click Event로 해서 단편적인 예시로 들었지만, 만약에 cellStyleCallback으로 들어가게 된다면, 조금 문제가 복잡해집니다.

```tsx
console.log(model.index.column.fieldName)
```

위처럼 fieldName 하나를 가짜로 지정하는데 depth가 많습니다.

일단 제 머리 속에서는 사실 이 방법 밖에 답이 없긴 합니다만,,,

테스트를 위한 해당 객체를 만드는 것도 결국은 일이다 보니, 이에 대해서 투자해야 할 시간도 상당하기에, 따로 테스트를 위한 사전 작업 및 가짓수(테스트할 방면에 대한 테스트) 또한 못해도 2일 정도는 투자 해야 할 듯 해 보입니다.

> 문제점 4

테스트 파일의 디렉토리 가독성

컴포넌트 파일 단위로 테스트를 진행 하다보니, 추후 unit Test와 core Test 시에도 지속적으로 테스트 코드를 보기 위해서 hcore 혹은 컴포넌트 디렉토리를 클릭하면서 작업을 해야 합니다.

초반에는 디렉토리 depth가 깊지 않아서 괜찮았는데, 최근에 모듈 분리와 고도화가 지속됨에 따라, test에 손이 잘 안가기도 하며, 가독성에 문제가 좀 있다보니, Spring의 구조처럼 따로 FE도 Test 모듈을 밖으로 빼고, 배포 시에는 Test 디렉토리만 삭제 후 배포 해보는 것도 나쁘지 않을 것 같습니다.

# 회의

## 테스트 가능 여부 판단

그냥 `.vue` 파일을 만든 후에, 테스트에 해당하는 컴포넌트들의 props 값만 넣어주면, 우선은 html dom 은 그려지니,, 해당 문제는 해결할 지도 모른다.