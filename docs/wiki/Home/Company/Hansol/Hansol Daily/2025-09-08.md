---
sticker: emoji//1f4c6
시작 날짜: 2025-09-08
종료 날짜: 2025-09-08
분류: 노트
---
- vue 마이그레이션 작업 - message box icon 문제

# vue router 새로고침 문제

changeTab 함수는 `${targetTab.to}?pcd=${targetTab.pcd}`형식의 URL 문자열을 만듭니다. 
그리고 addTab 함수는 changeTab을 호출하고 그 결과를 반환합니다.

 default.vue의 handleClickMenu는 addTab을 호출합니다.
```ts
const targetUrl = routerTab.addTab({ pcd: item.PROGRAM_CD, title: item.MENU_NM, to: item.PROGRAM_URL })
if (targetUrl) goTo(targetUrl)
```
item.PROGRAM_URL은 메뉴 데이터에서 가져옵니다. 
만약 item.PROGRAM_URL이 절대 URL(예: http://localhost:3000/some/path)이라면, targetUrl`http://localhost:3000/some/path?pcd=...`와 같은 전체 URL이 됩니다.

goTo()가 호출하는 router.push()에 전체 URL을 전달하면 전체 페이지가 새로고침될 수 있습니다. 
Vue Router 문서는 URL이 절대 경로이면 브라우저 탐색을트리거한다고 명시하고 있습니다.

문제의 간헐적인 특성은 일부 메뉴 항목에는 절대 URL이 있고 다른 항목에는 상대 경로가 있을 수 있음을 시사합니다. 
로그에 `http://localhost:3000/admin/prgm/prgm-list?pcd=A10101`라는 전체 URL이 표시되는 것으로 보아, 전체 URL이 구성되고 있음을 확인할 수 있습니다.

이 문제를 해결하려면 goTo가 항상 상대 경로로 호출되도록 해야 합니다.

가장 좋은 방법은 URL이 goTo로 전달되기 전에 수정하는 것입니다. changeTab 함수가 URL을 생성하는 중앙 지점이므로, 이 함수를 수정하는 것이 가장 효율적입니다.

changeTab 함수에서 URL이 http로 시작하는지 확인하고, 그렇다면 URL 객체를 사용하여 경로 이름(pathname)만 추출하도록 수정하겠습니다. 이렇게 하면 goTo
함수에는 항상 상대 경로만 전달되어 SPA 네비게이션이 올바르게 동작할 것입니다.